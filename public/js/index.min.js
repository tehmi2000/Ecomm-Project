let images=["null.png"],counter=0;const nextImage=function(){counter=counter===images.length-1?0:counter+1,document.querySelector("#banner").style.backgroundImage=`url(../assets/ads/${images[counter]})`},prevImage=function(){counter=0===counter?images.length-1:counter-1,document.querySelector("#banner").style.backgroundImage=`url(../assets/ads/${images[counter]})`},createItem=function(container,object){let price=formatAsMoney(parseInt(object["item-price"])),loadedImage=object["item-image"][0],originalPrice=function(){let intPrice=parseInt(object["item-price"]);return object["price-discount"]?`${formatAsMoney(intPrice/(100-parseInt(object["price-discount"])))}`:""}(),a0=createComponent("A",null,["strip-link","item","cols"]),div1=createComponent("DIV",null,["item-img"]),img0=createComponent("IMG",null,["lazyload"]),div2=createComponent("DIV",null,["item-description","cols"]),span0=createComponent("SPAN",object["item-name"].toUpperCase()),span1=createComponent("SPAN",price,["item-price"]),sup0=createComponent("SUP",originalPrice,["strike"]);a0.setAttribute("href",`/view/${object._id}`),img0.setAttribute("data-src",loadedImage),img0.setAttribute("alt","Item Image"),span1.appendChild(sup0),div1=joinComponent(div1,img0),div2=joinComponent(div2,span0,span1),a0=joinComponent(a0,div1,div2),container.appendChild(a0)},createDummyItem=function(container,length){for(let index=0;index<length;index++){let div0=createComponent("DIV",null,["dummy","item","cols"]),div1=createComponent("DIV",null,["item-img"]),img0=create("IMG"),div2=createComponent("DIV",null,["item-description","cols"]),span0=createComponent("SPAN",null),span1=createComponent("SPAN",null,["item-price"]);img0.setAttribute("src",""),img0.setAttribute("alt",""),div2=joinComponent(div2,span0,span1),div1=joinComponent(div1,img0),div0=joinComponent(div0,div1,div2),container.appendChild(div0)}},getAds=function(){const apiUrl="/api/ads/all";fetch(apiUrl).then(async response=>{try{let result=await response.json(),data=dataValidation(result).data;images=data,counter=Math.round(Math.random()*images.length)}catch(error){console.log(error)}}).catch(error=>{console.log(error)})},getMostPopular=function(){const container=document.querySelector("#most-popular-container.pane .slider");fetch("/api/goods/all/mostPopular").then((async function(response){try{let result=await response.json();container.innerHTML="";let data=dataValidation(result).data;data=data.slice(0,10),data.forEach(object=>{createItem(container,object)}),document.querySelectorAll(".item .item-description span:first-child").forEach(el=>{$clamp(el,{clamp:2})})}catch(error){console.error(error)}})).catch((function(error){console.error(error)}))},getRecommended=function(){const container=document.querySelector("#recommended-container.pane .slider");fetch("/api/goods/all/recommended").then((function(response){response.json().then((function(result){let data=dataValidation(result).data;randData=function(arr){let retArr=[],randIndex=0,selectedItem=null;for(;retArr.length<10;)randIndex=Math.ceil(Math.random()*(arr.length-1)),selectedItem=arr[randIndex],retArr.push(selectedItem),arr=arr.filter(item=>item._id!==selectedItem._id);return retArr}(data),container.innerHTML="",randData.forEach(object=>{createItem(container,object)}),document.querySelectorAll(".item .item-description span:first-child").forEach(el=>{$clamp(el,{clamp:2})})})).catch((function(error){console.error(error)}))})).catch((function(error){console.error(error)}))};document.addEventListener("DOMContentLoaded",(function(){createDummyItem(document.querySelector("#most-popular-container.pane .slider"),5),createDummyItem(document.querySelector("#recommended-container.pane .slider"),5),setInterval((function(){nextImage()}),8e3),getMostPopular(),getRecommended()})),window.onload=function(evt){getAds()};