let images=["null.png"],adsLinks=["#"],counter=0;const setImage=function(counter){counter=counter===images.length-1?0:counter+1,null!==images[counter]&&void 0!==images[counter]?(document.querySelector("#visit-ad-link").setAttribute("data-src",adsLinks[counter]),document.querySelector("#banner").style.backgroundImage=`url(../assets/adverts/${images[counter]})`):(document.querySelector("#visit-ad-link").setAttribute("data-src","#"),document.querySelector("#banner").style.backgroundImage="url(../assets/images/null.png)")},nextImage=function(){counter=counter===images.length-1?0:counter+1,setImage(counter)},prevImage=function(){counter=0===counter?images.length-1:counter-1,setImage(counter)},createItem=function(container,object){let price=formatAsMoney(parseFloat(object["item-price"]),currencyLocale),loadedImage=object["item-image"][0],originalPrice="";object["price-discount"]&&(originalPrice=function(){let intPrice=parseFloat(object["item-price"]);return`${formatAsMoney(intPrice/(100-parseFloat(object["price-discount"])),currencyLocale)}`}());let a0=createComponent("A",null,["strip-link","item","cols"]),div0=createComponent("DIV",`-${object["price-discount"]||"0"}%`,["item-discount"]),div1=createComponent("DIV",null,["item-img"]),img0=createComponent("IMG",null,["lazyload"]),div2=createComponent("DIV",null,["item-description","cols"]),span0=createComponent("SPAN",object["item-name"]),span1=createComponent("SPAN",price,["item-price"]),sup0=createComponent("SUP",originalPrice,["strike"]),div3=createComponent("DIV",null,["rows"]),imgaa=createComponent("IMG",null,["item-delivery-method"]),spanaa=createComponent("SPAN",null,["rows","item-location","icofont-airplane-alt"]);a0.setAttribute("href",`/view/${object._id}`),img0.setAttribute("data-src",loadedImage),img0.setAttribute("alt",`${object["item-name"].toLowerCase()}`),imgaa.setAttribute("src","/assets/images/express.png"),object["price-discount"]&&(div0.style.opacity=1),object["item-location"]&&object["item-location"]!==loggedInUserData&&(spanaa.style.opacity=1),imgaa.setAttribute("style","opacity: 0.7;height: 2rem;width: auto;object-fit: contain;"),div3.style.alignItems="flex-end",span1.appendChild(sup0),div1=joinComponent(div1,img0),div2=joinComponent(div2,span0,span1),div3=joinComponent(div3,imgaa,spanaa),a0=joinComponent(a0,div0,div1,div2,div3),container.appendChild(a0)},createCategoryItem=function(container,listOfobjects){let bgColors=["orange","dodgerblue","brown","crimson"];listOfobjects=listOfobjects.slice(0,6),container.innerHTML="",listOfobjects.forEach((category,index)=>{let a0=createComponent("a",null,["catitem","cols"]),div1=createComponent("DIV",null,["rows","item-img",`${category.image}`]),div2=createComponent("DIV",category.title,["item-name"]);a0.setAttribute("href",`/categories/view?query=${window.encodeURIComponent(category.title.toLowerCase())}`),a0=joinComponent(a0,div1,div2),a0.style.backgroundColor=bgColors[index]||generateRandomColor(),container.appendChild(a0)})},getAds=function(){const apiUrl="/api/adverts/all";fetch(apiUrl).then((async function(response){try{let result=await response.json(),data=dataValidation(result).data;images=data.map(each=>each.image),adsLinks=data.map(each=>null===each.href?"#":each.href),counter=Math.round(Math.random()*images.length),setInterval((function(){nextImage()}),8500)}catch(error){console.error(error)}})).catch(error=>{console.error(error)})},getMostPopular=function(){const container=document.querySelector("#most-popular-container.pane .slider");fetch("/api/goods/all/mostPopular").then((async function(response){try{let result=await response.json();container.innerHTML="";let data=dataValidation(result).data;data=data.slice(0,10),data.forEach(object=>{createItem(container,object)}),document.querySelectorAll(".item .item-description span:first-child").forEach(el=>{$clamp(el,{clamp:2})})}catch(error){console.error(error)}})).catch((function(error){console.error(error)}))},getRecommended=function(){const container=document.querySelector("#recommended-container.pane .slider");fetch("/api/goods/all/recommended").then((async function(response){try{let result=await response.json(),data=dataValidation(result).data,randData;if(window.Worker){if(void 0!==randWorker)try{randWorker.terminate()}catch(error){console.error(error)}finally{randWorker=void 0}randWorker=new Worker("/workers/randomize-ww.js"),randWorker.postMessage(data),randWorker.onmessage=function(e){randData=e.data,randWorker.terminate(),randWorker=void 0,container.innerHTML="",randData.forEach(object=>{createItem(container,object)})}}else randData=function(arr){let retArr=[],randIndex=0,selectedItem=null;for(;retArr.length<10;)randIndex=Math.ceil(Math.random()*(arr.length-1)),selectedItem=arr[randIndex],retArr.push(selectedItem),arr=arr.filter(item=>item._id!==selectedItem._id);return retArr}(data),container.innerHTML="",randData.forEach(object=>{createItem(container,object)});document.querySelectorAll(".item .item-description span:first-child").forEach(el=>{$clamp(el,{clamp:2})})}catch(error){console.error(error)}})).catch((function(error){console.error(error)}))},getDiscountedProducts=function(){const container=document.querySelector("#discounted-container.pane .slider");let apiUrl;fetch("/api/goods/all/with-filter/?discount=true").then(async response=>{try{let result=await response.json(),data=dataValidation(result).data;data.length>0?(container.innerHTML="",data.forEach(object=>{createItem(container,object)}),document.querySelectorAll(".item .item-description span:first-child").forEach(el=>{$clamp(el,{clamp:2})})):(container.style.justifyContent="center",container.style.alignItems="center",container.style.color="#999",container.style.fontSize="1.3rem",container.style.padding="3rem",container.innerHTML="<i>No discounted product available at the moment!</i>")}catch(error){console.error(error)}}).catch((function(error){console.error(error)}))},getCategories=function(){const container=document.querySelector("#categories-container .slider");fetch("/api/categories").then(async response=>{try{let result=await response.json(),data=dataValidation(result).data;createCategoryItem(container,data)}catch(error){console.error(error)}}).catch((function(error){console.error(error)}))};document.addEventListener("DOMContentLoaded",(function(){getMostPopular(),getCategories(),getDiscountedProducts(),getRecommended(),document.querySelector("#visit-ad-link").addEventListener("click",(function(ev){window.location.href=ev.currentTarget.getAttribute("data-src")}))})),window.onload=function(){getAds()};